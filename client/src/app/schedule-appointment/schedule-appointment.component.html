<div class="schedule-container">

  <!-- Charts Row -->
  <div class="charts-row">
    <div class="chart-card small-chart">
      <h3 class="section-title">Doctor Availability</h3>
      <canvas id="doctorChart"></canvas>
    </div>

    <div class="chart-card small-chart">
      <h3 class="section-title">Specialties Distribution</h3>
      <canvas id="specialityChart"></canvas>
    </div>
  </div>

  <!-- Doctors Table -->
  <div class="card mt-6 fade-in">
    <div class="card-header">
      <h4>Available Doctors</h4>
    </div>
    <div class="card-body">
      <table class="table table-hover">
        <thead>
          <tr>
            <th>#</th>
            <th>Name</th>
            <th>Specialty</th>
            <th>Availability</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody *ngFor="let val of doctorList; let i = index">
          <tr>
            <td>{{ i+1 }}</td>
            <td>{{ val.username }}</td>
            <td>{{ val.specialty }}</td>
            <td>
              <span [ngClass]="{'available': val.availability === 'Yes', 'not-available': val.availability !== 'Yes'}">
                {{ val.availability }}
              </span>
            </td>
            <td>
              <button *ngIf="val.availability === 'Yes'" 
                      type="button" 
                      (click)="addAppointment(val)" 
                      class="btn btn-primary btn-animate">
                Book Appointment
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Appointment Form -->
  <div *ngIf="isAdded" class="card fade-in mt-6">
    <div class="card-header">
      <h4>Schedule Appointment</h4>
    </div>
    <div class="card-body">
      <form class="mb-3 mt-md-4" [formGroup]="itemForm" (ngSubmit)="onSubmit()">
        <div class="mb-3">
          <label for="time" class="form-label">Appointment Time</label>
          <input type="hidden" formControlName="patientId">
          <input type="hidden" formControlName="doctorId">

          <input type="datetime-local" 
                 formControlName="time" 
                 [(ngModel)]="formModel.time" 
                 class="form-control stylish-input" 
                 id="time" 
                 placeholder="Choose appointment time">
          
          <div *ngIf="itemForm.controls['time'].invalid && (itemForm.controls['time'].dirty || itemForm.controls['time'].touched)" class="error-msg">
            <span>Please choose an appointment time.</span>
          </div>
        </div>

        <button class="btn btn-outline-dark btn-animate" type="submit">Confirm Appointment</button>
      </form>
    </div>
  </div>

  <!-- Success Message -->
  <div *ngIf="responseMessage" class="alert alert-success success-bounce mt-4" role="alert">
    {{ responseMessage }}
  </div>

</div>